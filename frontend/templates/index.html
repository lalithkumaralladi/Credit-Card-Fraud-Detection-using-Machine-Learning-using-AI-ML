<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Credit Card Fraud Detection</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <link href="/static/css/styles.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #4facfe 100%); 
            background-size: 400% 400%; 
            animation: gradientShift 15s ease infinite; 
        }
        @keyframes gradientShift { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        .glass-card { background: rgba(255, 255, 255, 0.95); -webkit-backdrop-filter: blur(10px); backdrop-filter: blur(10px); border-radius: 16px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); }
        nav { background: rgba(255, 255, 255, 0.95); -webkit-backdrop-filter: blur(10px); backdrop-filter: blur(10px); }
        .stat-card { transition: all 0.3s; }
        .stat-card:hover { transform: translateY(-5px) scale(1.02); }
        .animate-pulse-slow { animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
    </style>
</head>
<body class="min-h-screen">
    <!-- Navigation -->
    <nav class="shadow-lg">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <span class="text-xl font-bold bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 bg-clip-text text-transparent animate-pulse-slow">
                        <i class="fas fa-shield-alt mr-2 text-indigo-600"></i>FraudGuard AI Pro
                    </span>
                    <span class="ml-2 px-2 py-1 bg-green-100 text-green-700 text-xs font-bold rounded-full">LIVE</span>
                </div>
                <div class="hidden md:flex items-center space-x-4">
                    <a href="#" class="px-3 py-2 rounded-md text-sm font-medium hover:bg-indigo-50 text-gray-700" id="homeLink">Home</a>
                    <a href="#" class="px-3 py-2 rounded-md text-sm font-medium hover:bg-indigo-50 text-gray-700" id="dashboardLink">Dashboard</a>
                    <a href="#" class="px-3 py-2 rounded-md text-sm font-medium hover:bg-indigo-50 text-gray-700" id="aboutLink">About</a>
                    <button class="px-3 py-2 rounded-md text-sm font-medium hover:bg-indigo-50 text-gray-700" id="profileNavBtn">Profile</button>
                    <button class="bg-white text-indigo-600 px-4 py-2 rounded-md font-medium hover:bg-gray-100 border border-indigo-200" id="loginBtn">Login</button>
                    <button class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-4 py-2 rounded-md font-medium hover:from-indigo-700 hover:to-purple-700 transition-all shadow-lg" id="registerBtn">Register</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Upload Section -->
        <section id="uploadSection" class="max-w-4xl mx-auto glass-card p-6 mb-8 fade-in">
            <h2 class="text-2xl font-bold mb-6 bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">
                <i class="fas fa-robot mr-2"></i>AI-Powered Fraud Detection
            </h2>
            
            <!-- Advanced AI Insights Panel -->
            <div class="mb-6 glass-card p-5 border-l-4 border-indigo-500 shadow-lg">
                <div class="flex items-start justify-between">
                    <div class="flex-1">
                        <h4 class="font-bold text-indigo-700 mb-2 flex items-center">
                            <i class="fas fa-brain mr-2 text-indigo-600 animate-pulse-slow"></i>AI-Powered Analysis Engine
                        </h4>
                        <p class="text-sm text-gray-700 mb-3">Advanced machine learning algorithms analyze your transaction data in real-time. Upload CSV files up to 500MB for instant fraud detection with comprehensive visualizations.</p>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mt-3">
                            <div class="flex items-center space-x-2 text-xs">
                                <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                                <span class="font-semibold text-gray-700">Real-time Analysis</span>
                            </div>
                            <div class="flex items-center space-x-2 text-xs">
                                <div class="w-2 h-2 bg-blue-500 rounded-full animate-pulse"></div>
                                <span class="font-semibold text-gray-700">Basic Graphs</span>
                            </div>
                            <div class="flex items-center space-x-2 text-xs">
                                <div class="w-2 h-2 bg-purple-500 rounded-full animate-pulse"></div>
                                <span class="font-semibold text-gray-700">AI Insights</span>
                            </div>
                            <div class="flex items-center space-x-2 text-xs">
                                <div class="w-2 h-2 bg-red-500 rounded-full animate-pulse"></div>
                                <span class="font-semibold text-gray-700">500MB Files</span>
                            </div>
                        </div>
                    </div>
                    <div class="ml-4">
                        <div class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-4 py-2 rounded-lg text-center">
                            <div class="text-2xl font-bold" id="processingSpeed">0.0s</div>
                            <div class="text-xs">Avg Speed</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="border-3 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-indigo-500 transition-all duration-300 dropzone-enhanced" id="dropZone">
                <i class="fas fa-cloud-upload-alt text-5xl text-blue-500 mb-4"></i>
                <p class="text-gray-600 mb-2">Drag & drop your CSV file here or</p>
                <input type="file" id="fileInput" class="hidden" accept=".csv" aria-label="Select CSV file to upload">
                    <button id="browseBtn" class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-6 py-2 rounded-md hover:from-indigo-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all shadow-lg" aria-label="Browse files">
                        <i class="fas fa-folder-open mr-2"></i>Browse Files
                    </button>
                <p class="text-sm text-gray-500 mt-2">Supports: CSV files only (Max 500MB)</p>
            </div>
            
            <div id="fileInfo" class="mt-4 hidden">
                <div class="flex items-center justify-between bg-gray-50 p-3 rounded-md">
                    <div class="flex items-center">
                        <i class="fas fa-file-csv text-blue-500 text-2xl mr-3"></i>
                        <div>
                            <p class="font-medium text-gray-800" id="fileName"></p>
                            <p class="text-sm text-gray-500" id="fileSize"></p>
                        </div>
                    </div>
                    <div class="flex space-x-2">
                        <button id="analyzeBtn" class="bg-gradient-to-r from-green-500 to-emerald-600 text-white px-4 py-1 rounded-md hover:from-green-600 hover:to-emerald-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-all shadow-md" aria-label="Analyze uploaded file with AI">
                            <i class="fas fa-brain mr-1"></i> Analyze with AI
                        </button>
                        <button id="removeFile" class="text-red-500 hover:text-red-700 focus:outline-none" aria-label="Remove selected file">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Loading Indicator -->
        <div id="loadingIndicator" class="hidden max-w-4xl mx-auto bg-white rounded-lg shadow-md p-8 text-center mb-8">
            <div class="animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-500 mx-auto mb-4"></div>
            <h3 class="text-lg font-medium text-gray-800">Processing Your Data</h3>
            <p class="text-gray-600" id="progressText">This may take a few moments. Please wait...</p>
            <div class="w-full bg-gray-200 rounded-full h-2.5 mt-4">
                <div id="progressBar" class="bg-blue-600 h-2.5 rounded-full transition-all duration-300" style="width: 0%"></div>
            </div>
        </div>
            <button class="bg-blue-600 text-white px-8 py-3 rounded-full font-semibold hover:bg-blue-700 transition duration-300" id="getStartedBtn">Get Started</button>
        </section>

        <!-- Authentication Modals -->
        <!-- Results Section -->
        <section id="resultsSection" class="max-w-6xl mx-auto bg-white rounded-lg shadow-md p-6 hidden">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800">Analysis Results</h2>
                <div class="flex space-x-3">
                    <button id="downloadReportBtn" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors flex items-center" aria-label="Download analysis report as PDF">
                        <i class="fas fa-file-pdf mr-2"></i> Download Report
                    </button>
                    <button id="downloadProcessedCsvBtn" class="bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors flex items-center" aria-label="Download processed CSV file">
                        <i class="fas fa-file-csv mr-2"></i> Download Processed CSV
                    </button>
                </div>
            </div>

            <!-- Advanced Summary Cards -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                <div class="stat-card glass-card p-6 border-l-4 border-blue-500">
                    <div class="flex items-center justify-between mb-2">
                        <h3 class="text-sm font-semibold text-gray-600 uppercase tracking-wider">Total Transactions</h3>
                        <i class="fas fa-database text-blue-500 text-xl"></i>
                    </div>
                    <p class="text-4xl font-bold text-blue-600 mb-1" id="totalTransactions">0</p>
                    <p class="text-xs text-gray-500">Processed successfully</p>
                </div>
                <div class="stat-card glass-card p-6 border-l-4 border-green-500">
                    <div class="flex items-center justify-between mb-2">
                        <h3 class="text-sm font-semibold text-gray-600 uppercase tracking-wider">Genuine</h3>
                        <i class="fas fa-check-circle text-green-500 text-xl"></i>
                    </div>
                    <p class="text-4xl font-bold text-green-600 mb-1" id="genuineCount">0</p>
                    <p class="text-xs text-gray-500" id="genuinePercent">0%</p>
                </div>
                <div class="stat-card glass-card p-6 border-l-4 border-red-500">
                    <div class="flex items-center justify-between mb-2">
                        <h3 class="text-sm font-semibold text-gray-600 uppercase tracking-wider">Fraudulent</h3>
                        <i class="fas fa-exclamation-triangle text-red-500 text-xl"></i>
                    </div>
                    <p class="text-4xl font-bold text-red-600 mb-1" id="fraudulentCount">0</p>
                    <p class="text-xs text-gray-500" id="fraudPercent">0%</p>
                </div>
                <div class="stat-card glass-card p-6 border-l-4 border-purple-500">
                    <div class="flex items-center justify-between mb-2">
                        <h3 class="text-sm font-semibold text-gray-600 uppercase tracking-wider">Risk Score</h3>
                        <i class="fas fa-chart-line text-purple-500 text-xl"></i>
                    </div>
                    <p class="text-4xl font-bold text-purple-600 mb-1" id="riskScore">0%</p>
                    <p class="text-xs text-gray-500">Overall assessment</p>
                </div>
            </div>

            <!-- Model Performance Metrics -->
            <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-100 mb-8">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">Model Performance Metrics</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    <div class="p-4 bg-blue-50 rounded-lg">
                        <p class="text-sm text-gray-500">Accuracy</p>
                        <p class="text-2xl font-bold text-blue-600" id="accuracy">0%</p>
                        <p class="text-xs text-gray-500 mt-1">Correct predictions</p>
                    </div>
                    <div class="p-4 bg-green-50 rounded-lg">
                        <p class="text-sm text-gray-500">Precision</p>
                        <p class="text-2xl font-bold text-green-600" id="precision">0%</p>
                        <p class="text-xs text-gray-500 mt-1">True positives / (True + False Positives)</p>
                    </div>
                    <div class="p-4 bg-yellow-50 rounded-lg">
                        <p class="text-sm text-gray-500">Recall</p>
                        <p class="text-2xl font-bold text-yellow-600" id="recall">0%</p>
                        <p class="text-xs text-gray-500 mt-1">True positives / (True Positives + False Negatives)</p>
                    </div>
                    <div class="p-4 bg-purple-50 rounded-lg">
                        <p class="text-sm text-gray-500">F1 Score</p>
                        <p class="text-2xl font-bold text-purple-600" id="f1Score">0%</p>
                        <p class="text-xs text-gray-500 mt-1">Harmonic mean of precision and recall</p>
                    </div>
                </div>

                <!-- Confusion Matrix -->
                <div class="mt-6">
                    <h4 class="text-lg font-medium text-gray-700 mb-3">Confusion Matrix</h4>
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white border border-gray-200">
                            <thead>
                                <tr>
                                    <th class="px-4 py-2 border border-gray-300 bg-gray-100"></th>
                                    <th class="px-4 py-2 border border-gray-300 bg-gray-100 text-red-600" colspan="2">Predicted</th>
                                </tr>
                                <tr>
                                    <th class="px-4 py-2 border border-gray-300 bg-gray-100">Actual</th>
                                    <th class="px-4 py-2 border border-gray-300 bg-red-50 text-red-600">Fraud</th>
                                    <th class="px-4 py-2 border border-gray-300 bg-green-50 text-green-600">Genuine</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="px-4 py-2 border border-gray-300 bg-red-50 text-red-600 font-medium">Fraud</td>
                                    <td class="px-4 py-2 border border-gray-300 text-center" id="truePositives">0</td>
                                    <td class="px-4 py-2 border border-gray-300 text-center" id="falseNegatives">0</td>
                                </tr>
                                <tr>
                                    <td class="px-4 py-2 border border-gray-300 bg-green-50 text-green-600 font-medium">Genuine</td>
                                    <td class="px-4 py-2 border border-gray-300 text-center" id="falsePositives">0</td>
                                    <td class="px-4 py-2 border border-gray-300 text-center" id="trueNegatives">0</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Advanced Python Generated Graphs Section -->
            <div id="pythonGraphsSection" class="mb-8 hidden">
                <div class="glass-card p-6 mb-6 shadow-xl border-t-4 border-indigo-500">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <h2 class="text-3xl font-bold mb-2 bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 bg-clip-text text-transparent">
                                <i class="fas fa-chart-line mr-2"></i>Advanced AI Visualizations
                            </h2>
                            <p class="text-gray-600">Professional-grade graphs powered by Python matplotlib & seaborn</p>
                        </div>
                        <div class="flex items-center space-x-2 px-4 py-2 bg-green-100 rounded-full">
                            <i class="fas fa-check-circle text-green-600"></i>
                            <span class="text-sm font-semibold text-green-700">Basic Graphs Ready</span>
                        </div>
                    </div>
                </div>
                
                <!-- Graph Row 1: Class Distribution & Amount Distribution -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <!-- Class Distribution Pie Chart -->
                    <div class="glass-card p-6 shadow-lg fade-in">
                        <h3 class="text-lg font-semibold text-gray-800 mb-2 flex items-center">
                            <i class="fas fa-chart-pie mr-2 text-indigo-600"></i>Class Distribution
                            <span class="ml-2 text-xs bg-indigo-100 text-indigo-700 px-2 py-1 rounded-full font-semibold">Python Generated</span>
                        </h3>
                        <p class="text-sm text-gray-600 mb-4">Shows percentage of genuine transactions versus fraudulent transactions in your uploaded data.</p>
                        <div class="flex justify-center items-center bg-gradient-to-br from-gray-50 to-indigo-50 rounded-lg p-4 border-2 border-dashed border-indigo-200" style="min-height: 400px;">
                            <img id="classDistributionGraph" src="" alt="Class Distribution" class="max-w-full h-auto rounded-lg shadow-xl" style="display: none;">
                            <div id="classDistributionLoading" class="text-gray-500 flex items-center">
                                <i class="fas fa-spinner fa-spin mr-2"></i>Generating graph...
                            </div>
                        </div>
                    </div>
                    
                    <!-- Amount Distribution Chart -->
                    <div class="glass-card p-6 shadow-xl fade-in border-t-4 border-blue-500 hover:shadow-2xl transition-all">
                        <h3 class="text-lg font-bold text-gray-800 mb-2 flex items-center justify-between">
                            <span class="flex items-center"><i class="fas fa-chart-bar mr-2 text-blue-600"></i>Transaction Amount Distribution</span>
                            <span class="text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-full font-semibold">Python Generated</span>
                        </h3>
                        <p class="text-sm text-gray-600 mb-4">Displays transaction amounts distribution. Red bars show fraudulent transactions, blue bars show genuine transactions.</p>
                        <div class="flex justify-center items-center bg-gradient-to-br from-gray-50 to-blue-50 rounded-lg p-4 border-2 border-dashed border-blue-200" style="min-height: 400px;">
                            <img id="amountDistributionGraph" src="" alt="Amount Distribution" class="max-w-full h-auto rounded-lg shadow-xl" style="display: none;">
                            <div id="amountDistributionLoading" class="text-gray-500 flex items-center">
                                <i class="fas fa-spinner fa-spin mr-2"></i>Generating graph...
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Graph Row 2: Confusion Matrix & Metrics Chart -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <!-- Confusion Matrix Heatmap -->
                    <div class="glass-card p-6 shadow-lg fade-in">
                        <h3 class="text-lg font-semibold text-gray-800 mb-2 flex items-center">
                            <i class="fas fa-table mr-2 text-indigo-600"></i>Confusion Matrix Heatmap
                        </h3>
                        <p class="text-sm text-gray-600 mb-4">Shows how accurately the model predicted fraudulent versus genuine transactions. Green means correct predictions.</p>
                        <div class="flex justify-center items-center bg-gray-50 rounded-lg p-4" style="min-height: 400px;">
                            <img id="confusionMatrixGraph" src="" alt="Confusion Matrix" class="max-w-full h-auto rounded-lg shadow-md" style="display: none;">
                            <div id="confusionMatrixLoading" class="text-gray-500">Loading graph...</div>
                        </div>
                    </div>
                    
                    <!-- Model Performance Metrics -->
                    <div class="glass-card p-6 shadow-lg fade-in">
                        <h3 class="text-lg font-semibold text-gray-800 mb-2 flex items-center">
                            <i class="fas fa-chart-bar mr-2 text-indigo-600"></i>Model Performance Metrics
                        </h3>
                        <p class="text-sm text-gray-600 mb-4">Displays model accuracy, precision, recall, and F1 score. Higher percentages mean better fraud detection performance.</p>
                        <div class="flex justify-center items-center bg-gray-50 rounded-lg p-4" style="min-height: 400px;">
                            <img id="metricsChartGraph" src="" alt="Metrics Chart" class="max-w-full h-auto rounded-lg shadow-md" style="display: none;">
                            <div id="metricsChartLoading" class="text-gray-500">Loading graph...</div>
                        </div>
                    </div>
                </div>

                <!-- Graph Row 3: Correlation Heatmap & Time Series -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <!-- Correlation Heatmap -->
                    <div class="glass-card p-6 shadow-lg fade-in">
                        <h3 class="text-lg font-semibold text-gray-800 mb-2 flex items-center">
                            <i class="fas fa-project-diagram mr-2 text-indigo-600"></i>Feature Correlation Heatmap
                        </h3>
                        <p class="text-sm text-gray-600 mb-4">Shows relationships between different transaction features. Red means strong positive relationship, blue means negative relationship.</p>
                        <div class="flex justify-center items-center bg-gray-50 rounded-lg p-4" style="min-height: 500px;">
                            <img id="correlationHeatmapGraph" src="" alt="Correlation Heatmap" class="max-w-full h-auto rounded-lg shadow-md" style="display: none;">
                            <div id="correlationHeatmapLoading" class="text-gray-500">Loading graph...</div>
                        </div>
                    </div>
                    
                    <!-- Time Series Chart -->
                    <div class="glass-card p-6 shadow-lg fade-in">
                        <h3 class="text-lg font-semibold text-gray-800 mb-2 flex items-center">
                            <i class="fas fa-clock mr-2 text-indigo-600"></i>Transaction Distribution by Hour
                        </h3>
                        <p class="text-sm text-gray-600 mb-4">Shows when transactions occur throughout the day. Helps identify peak transaction hours and unusual patterns.</p>
                        <div class="flex justify-center items-center bg-gray-50 rounded-lg p-4" style="min-height: 500px;">
                            <img id="timeSeriesGraph" src="" alt="Time Series" class="max-w-full h-auto rounded-lg shadow-md" style="display: none;">
                            <div id="timeSeriesLoading" class="text-gray-500">Loading graph...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Transaction Table -->
            <div class="bg-white rounded-lg shadow-sm border border-gray-100 overflow-hidden">
                <div class="p-4 border-b border-gray-200">
                    <h3 class="text-lg font-medium text-gray-800">Sample Transactions</h3>
                </div>
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Time</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Amount ($)</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Confidence</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200" id="transactionsTableBody">
                            <!-- Transaction rows will be inserted here by JavaScript -->
                            <tr>
                                <td colspan="4" class="px-6 py-4 text-center text-gray-500">No transaction data available</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="bg-gray-50 px-6 py-3 flex items-center justify-between border-t border-gray-200">
                    <div class="text-sm text-gray-500">
                        Showing <span id="startItem">1</span> to <span id="endItem">10</span> of <span id="totalItems">0</span> transactions
                    </div>
                    <div class="flex space-x-2">
                        <button id="prevPage" class="px-3 py-1 border border-gray-300 rounded-md bg-white text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed" aria-label="Go to previous page">
                            Previous
                        </button>
                        <button id="nextPage" class="px-3 py-1 border border-gray-300 rounded-md bg-white text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed" aria-label="Go to next page">
                            Next
                        </button>
                    </div>
                </div>
            </div>
        </section>
                <form id="loginForm">
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="loginEmail">Email</label>
                        <input type="email" id="loginEmail" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="loginPassword">Password</label>
                        <input type="password" id="loginPassword" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                    <button type="submit" class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
                        Sign In
                    </button>
                    <div class="text-center mt-4">
                        <button type="button" class="text-blue-600 hover:underline" id="showRegisterForm">Create an account</button>
                    </div>
                    <div class="mt-6">
                        <div class="relative">
                            <div class="absolute inset-0 flex items-center">
                                <div class="w-full border-t border-gray-300"></div>
                            </div>
                            <div class="relative flex justify-center text-sm">
                                <span class="px-2 bg-white text-gray-500">Or continue with</span>
                            </div>
                        </div>
                        <div class="mt-6 grid grid-cols-2 gap-3">
                            <button type="button" class="w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500" id="googleLogin">
                                <i class="fab fa-google text-red-500 mr-2"></i> Google
                            </button>
                            <button type="button" class="w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                <i class="fab fa-microsoft text-blue-500 mr-2"></i> Microsoft
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <div id="registerModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
            <div class="bg-white rounded-lg p-8 max-w-md w-full mx-4">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">Create Account</h2>
                    <button class="text-gray-500 hover:text-gray-700" id="closeRegisterModal">&times;</button>
                </div>
                <form id="registerForm">
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2" for="firstName">First Name</label>
                            <input type="text" id="firstName" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2" for="lastName">Last Name</label>
                            <input type="text" id="lastName" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                        </div>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="registerEmail">Email</label>
                        <input type="email" id="registerEmail" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="registerPassword">Password</label>
                        <input type="password" id="registerPassword" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="confirmPassword">Confirm Password</label>
                        <input type="password" id="confirmPassword" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                    <button type="submit" class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
                        Create Account
                    </button>
                    <div class="text-center mt-4">
                        <button type="button" class="text-blue-600 hover:underline" id="showLoginForm">Already have an account? Sign in</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Dashboard Section (initially hidden) -->
        <section id="dashboard" class="hidden">
            <div class="bg-white shadow-md rounded-lg p-6 mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">Upload Credit Card Transaction Data</h2>
                <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center" id="dropZone">
                    <i class="fas fa-cloud-upload-alt text-4xl text-blue-500 mb-4"></i>
                    <p class="text-gray-600 mb-2">Drag & drop your CSV file here or</p>
                    <input type="file" id="fileInput2" class="hidden" accept=".csv" aria-label="Upload CSV file">
                    <button id="browseBtn2" class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2" aria-label="Browse files to upload">
                        Browse Files
                    </button>
                    <p class="text-sm text-gray-500 mt-2">Supports: CSV files only (Max 500MB)</p>
                </div>
                <div id="fileInfo" class="mt-4 hidden">
                    <div class="flex items-center justify-between bg-gray-50 p-3 rounded-md">
                        <div class="flex items-center">
                            <i class="fas fa-file-csv text-blue-500 mr-3"></i>
                            <div>
                                <p class="font-medium text-gray-800" id="fileName2"></p>
                                <p class="text-sm text-gray-500" id="fileSize2"></p>
                            </div>
                        </div>
                        <button id="removeFile2" class="text-red-500 hover:text-red-700" aria-label="Remove file">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="mt-4">
                        <button id="analyzeBtn2" class="w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2" aria-label="Analyze Transactions">
                            Analyze Transactions
                        </button>
                    </div>
                </div>
            </div>

            <!-- Results Section (initially hidden) -->
            <div id="resultsSection" class="hidden">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-semibold text-gray-800 mb-2">Total Transactions</h3>
                        <p class="text-3xl font-bold text-blue-600" id="totalTransactions">0</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-semibold text-gray-800 mb-2">Fraudulent</h3>
                        <p class="text-3xl font-bold text-red-600" id="fraudulentCount">0</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-semibold text-gray-800 mb-2">Genuine</h3>
                        <p class="text-3xl font-bold text-green-600" id="genuineCount">0</p>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Class Distribution</h3>
                        <div class="h-64 flex items-center justify-center">
                            <img id="classDistributionChart" src="" alt="Class Distribution Chart" class="max-w-full max-h-full">
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Confusion Matrix</h3>
                        <div class="h-64 flex items-center justify-center">
                            <img id="confusionMatrixChart" src="" alt="Confusion Matrix Chart" class="max-w-full max-h-full">
                        </div>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-lg shadow-md mb-8">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Transaction Details</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Time</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Amount</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Confidence</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200" id="transactionsTableBody">
                                <!-- Transactions will be populated here -->
                            </tbody>
                        </table>
                    </div>
                    <div class="mt-4 flex justify-between items-center">
                        <div class="text-sm text-gray-500">
                            Showing <span id="startItem">1</span> to <span id="endItem">10</span> of <span id="totalItems">0</span> transactions
                        </div>
                        <div class="flex space-x-2">
                            <button id="prevPage2" class="px-3 py-1 border rounded-md bg-white text-gray-700 hover:bg-gray-50" aria-label="Previous page">Previous</button>
                            <button id="nextPage2" class="px-3 py-1 border rounded-md bg-white text-gray-700 hover:bg-gray-50" aria-label="Next page">Next</button>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end space-x-4 mb-8">
                    <button id="downloadReportBtn2" class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2" aria-label="Download PDF Report">
                        <i class="fas fa-download mr-2"></i>Download Report
                    </button>
                    <button id="downloadProcessedCsvBtn2" class="bg-green-600 text-white px-6 py-2 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2" aria-label="Download Processed CSV file">
                        <i class="fas fa-file-csv mr-2"></i>Download Processed CSV
                    </button>
                </div>
            </div>
        </section>

        <!-- About Section -->
        <section id="about" class="py-12 bg-white rounded-lg shadow-md p-6 hidden">
            <h2 class="text-3xl font-bold text-center text-gray-800 mb-8">About FraudGuard</h2>
            
            <div class="max-w-4xl mx-auto">
                <div class="mb-12">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Our Mission</h3>
                    <p class="text-gray-600 leading-relaxed">
                        At FraudGuard, we're committed to providing cutting-edge fraud detection solutions that help businesses protect their revenue and customers from fraudulent activities. Our AI-powered platform uses advanced machine learning algorithms to identify suspicious transactions in real-time, reducing financial losses and enhancing security.
                    </p>
                </div>

                <div class="mb-12">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">How It Works</h3>
                    <div class="grid md:grid-cols-3 gap-8">
                        <div class="text-center">
                            <div class="bg-blue-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-upload text-blue-600 text-2xl"></i>
                            </div>
                            <h4 class="font-semibold text-gray-800 mb-2">1. Upload Data</h4>
                            <p class="text-gray-600 text-sm">Upload your credit card transaction data in CSV format.</p>
                        </div>
                        <div class="text-center">
                            <div class="bg-blue-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-cogs text-blue-600 text-2xl"></i>
                            </div>
                            <h4 class="font-semibold text-gray-800 mb-2">2. Analyze</h4>
                            <p class="text-gray-600 text-sm">Our AI processes and analyzes the data for potential fraud.</p>
                        </div>
                        <div class="text-center">
                            <div class="bg-blue-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-chart-bar text-blue-600 text-2xl"></i>
                            </div>
                            <h4 class="font-semibold text-gray-800 mb-2">3. Get Insights</h4>
                            <p class="text-gray-600 text-sm">View detailed reports and download results for further analysis.</p>
                        </div>
                    </div>
                </div>

                <div class="mb-8">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Key Features</h3>
                    <ul class="grid md:grid-cols-2 gap-4">
                        <li class="flex items-start">
                            <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                            <span class="text-gray-700">Real-time transaction monitoring</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                            <span class="text-gray-700">Advanced machine learning models</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                            <span class="text-gray-700">Interactive visualizations</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                            <span class="text-gray-700">Detailed reporting</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                            <span class="text-gray-700">Secure data handling</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                            <span class="text-gray-700">User-friendly interface</span>
                        </li>
                    </ul>
                </div>

                <div class="bg-blue-50 p-6 rounded-lg">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Get Started Today</h3>
                    <p class="text-gray-600 mb-4">
                        Ready to protect your business from credit card fraud? Sign up for a free account and start analyzing your transaction data in minutes.
                    </p>
                    <button class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2" id="getStartedAboutBtn">
                        Get Started for Free
                    </button>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-8 mt-12">
        <div class="max-w-7xl mx-auto px-4">
            <div class="text-center">
                </div>
                <div>
                    <h4 class="text-md font-semibold mb-4">Connect With Us</h4>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-linkedin"></i></a>
                        <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-github"></i></a>
                        <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-facebook"></i></a>
                    </div>
                    <div class="mt-4">
                        <p class="text-sm text-gray-400">Subscribe to our newsletter</p>
                        <div class="flex mt-2">
                            <input type="email" placeholder="Your email" class="px-3 py-2 bg-gray-700 text-white rounded-l-md focus:outline-none focus:ring-2 focus:ring-blue-500 w-full">
                            <button class="bg-blue-600 text-white px-4 rounded-r-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-6 text-center text-gray-400 text-sm">
                <p>&copy; 2023 FraudGuard. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>
    <script src="/static/js/auth.js?v=2"></script>
    <script src="/static/js/app.js?v=2"></script>
    <script src="/static/js/upload.js?v=2"></script>
    
    <!-- Profile Modal -->
    <div id="profileModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="flex items-center justify-between px-6 py-4 border-b">
                <h3 class="text-lg font-semibold text-gray-800">Profile</h3>
                <button id="closeProfileModal" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-6">
                <div class="flex items-center space-x-4 mb-4">
                    <img id="profileAvatar" src="https://www.gravatar.com/avatar/00000000000000000000000000000000?d=mp&f=y" alt="Avatar" class="w-16 h-16 rounded-full border">
                    <div>
                        <div id="profileName" class="text-xl font-semibold text-gray-800">User</div>
                        <div id="profileEmail" class="text-sm text-gray-600">user@example.com</div>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-gray-50 p-3 rounded">
                        <div class="text-xs text-gray-500">Status</div>
                        <div class="text-sm font-medium text-green-600">Online</div>
                    </div>
                    <div class="bg-gray-50 p-3 rounded">
                        <div class="text-xs text-gray-500">Role</div>
                        <div class="text-sm font-medium text-gray-800">User</div>
                    </div>
                </div>
            </div>
            <div class="px-6 py-4 border-t flex justify-end space-x-3">
                <button id="closeProfileModal2" class="px-4 py-2 rounded bg-gray-100 text-gray-700 hover:bg-gray-200">Close</button>
            </div>
        </div>
    </div>
    
    <!-- AI Chat Widget -->
    <div class="ai-chat-widget" id="aiChatWidget" title="AI Assistant">
        <i class="fas fa-robot"></i>
    </div>
    
    <!-- AI Chat Modal -->
    <div id="aiChatModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[600px] flex flex-col">
            <div class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white p-4 rounded-t-lg flex justify-between items-center">
                <h3 class="font-bold"><i class="fas fa-robot mr-2"></i>AI Assistant</h3>
                <button id="closeChatModal" class="text-white hover:text-gray-200">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="chatMessages" class="flex-1 overflow-y-auto p-4 space-y-4">
                <div class="bg-indigo-50 p-3 rounded-lg">
                    <p class="text-sm text-gray-700">Hello! I'm your AI fraud detection assistant. Ask me anything about fraud detection, your data, or get insights!</p>
                </div>
            </div>
            <div class="p-4 border-t">
                <div class="flex space-x-2">
                    <input type="text" id="chatInput" placeholder="Ask about fraud detection..." class="flex-1 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    <button id="sendChatBtn" class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-4 py-2 rounded-lg hover:from-indigo-700 hover:to-purple-700">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // AI Chat Widget
        const aiChatWidget = document.getElementById('aiChatWidget');
        const aiChatModal = document.getElementById('aiChatModal');
        const closeChatModal = document.getElementById('closeChatModal');
        const sendChatBtn = document.getElementById('sendChatBtn');
        const chatInput = document.getElementById('chatInput');
        const chatMessages = document.getElementById('chatMessages');
        
        if (aiChatWidget) {
            aiChatWidget.addEventListener('click', () => {
                aiChatModal.classList.remove('hidden');
            });
        }
        
        if (closeChatModal) {
            closeChatModal.addEventListener('click', () => {
                aiChatModal.classList.add('hidden');
            });
        }
        
        function addChatMessage(message, isUser = false) {
            const div = document.createElement('div');
            div.className = isUser ? 'bg-indigo-600 text-white p-3 rounded-lg ml-auto max-w-[80%]' : 'bg-indigo-50 p-3 rounded-lg max-w-[80%]';
            div.innerHTML = `<p class="text-sm">${message}</p>`;
            chatMessages.appendChild(div);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        if (sendChatBtn && chatInput) {
            sendChatBtn.addEventListener('click', () => {
                const message = chatInput.value.trim();
                if (message) {
                    addChatMessage(message, true);
                    chatInput.value = '';
                    
                    // Simulate AI response
                    setTimeout(() => {
                        const responses = [
                            "Based on your data, I recommend focusing on transactions above $1000 as they show higher fraud probability.",
                            "Your model accuracy looks great! Consider reviewing the false positives to improve precision.",
                            "I've detected some patterns in your dataset. Would you like me to generate a detailed report?",
                            "The fraud detection rate is optimal. Keep monitoring for new patterns.",
                            "Based on the confusion matrix, your model performs well on genuine transactions. Consider fine-tuning for fraud cases."
                        ];
                        addChatMessage(responses[Math.floor(Math.random() * responses.length)]);
                    }, 1000);
                }
            });
            
            chatInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendChatBtn.click();
                }
            });
        }
    </script>
</body>
</html>
